#!/usr/bin/env python3



import subprocess

import os

import sys



def run_command(command):

    try:

        process = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True, text=True)

        output, error = process.communicate()

        if process.returncode != 0:

            print(f"Error executing command: {command}")

            print(f"Error message: {error}")

            return None

        return output

    except Exception as e:

        print(f"An error occurred while running the command: {e}")

        return None



def check_tool(tool_name):

    if not run_command(f"which {tool_name}"):

        print(f"Error: {tool_name} is not installed or not in PATH.")

        print(f"Please install {tool_name} and try again.")

        sys.exit(1)



def main():

    print("Let's check for Vulnerable Frontpage Server Extensions")

    print("=" * 50)

    print("Hi, How are you? I created this script")

    print("=" * 50)



    # Check if required tools are installed

    check_tool("subfinder")

    check_tool("nuclei")



    domain = input("Enter the domain to scan: ")



    # Clean up any previous output files

    if os.path.exists("subdomains.txt"):

        os.remove("subdomains.txt")

    if os.path.exists("CVE-2000-0114valid.txt"):

        os.remove("CVE-2000-0114valid.txt")



    print("\nEnumerating subdomains...")

    subfinder_output = run_command(f"subfinder -d {domain} -o subdomains.txt")

    if subfinder_output is None:

        print("Failed to enumerate subdomains. Exiting.")

        sys.exit(1)



    if not os.path.exists("subdomains.txt"):

        print("No subdomains found. Exiting.")

        sys.exit(1)



    with open("subdomains.txt", "r") as f:

        subdomains = f.read().splitlines()

    print(f"Found {len(subdomains)} subdomains.")



    print("\nRunning vulnerability scan...")

    nuclei_template = "/home/kali/nuclei-templates/http/cves/2000/CVE-2000-0114.yaml"

    if not os.path.exists(nuclei_template):

        print(f"Error: Nuclei template not found at {nuclei_template}")

        print("Please ensure the template exists and try again.")

        sys.exit(1)



    nuclei_output = run_command(f"nuclei -l subdomains.txt -t {nuclei_template} -o CVE-2000-0114valid.txt")

    if nuclei_output is None:

        print("Failed to run vulnerability scan. Exiting.")

        sys.exit(1)



    if os.path.exists("CVE-2000-0114valid.txt") and os.path.getsize("CVE-2000-0114valid.txt") > 0:

        with open("CVE-2000-0114valid.txt", "r") as f:

            vulnerable = f.read().strip()

        print(f"\nVulnerable subdomain(s) found:\n{vulnerable}")

    else:

        print("\nNo vulnerable subdomains found.")



    # Clean up

    if os.path.exists("subdomains.txt"):

        os.remove("subdomains.txt")

    if os.path.exists("CVE-2000-0114valid.txt"):

        os.remove("CVE-2000-0114valid.txt")



    print("\nScan completed.")

    print("=" * 50)

    print("Checkout My LinkedIn")

    print("https://www.linkedin.com/in/josekutty-kunnelthazhe-binu-9b484429b/")



if __name__ == "__main__":

    main()


