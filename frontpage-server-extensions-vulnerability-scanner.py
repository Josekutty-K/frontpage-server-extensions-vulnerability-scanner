#!/usr/bin/env python3



import subprocess

import os



def run_command(command):

    process = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True, text=True)

    output, _ = process.communicate()

    return output



def main():

    print("Lets check for Vulnerable Frontpage Server Extensions")

    print("=" * 50)

    print("Hi, How are you? I created this script")

    print("=" * 50)



    domain = input("Enter the domain to scan: ")



    print("\nEnumerating subdomains...")

    run_command(f"subfinder -d {domain} -o subdomains.txt")



    with open("subdomains.txt", "r") as f:

        subdomains = f.read().splitlines()

    print(f"Found {len(subdomains)} subdomains.")



    print("\nRunning vulnerability scan...")

    output = run_command(f"nuclei -l subdomains.txt -t /home/kali/nuclei-templates/http/cves/2000/CVE-2000-0114.yaml -o CVE-2000-0114valid.txt")



    if os.path.exists("CVE-2000-0114valid.txt") and os.path.getsize("CVE-2000-0114valid.txt") > 0:

        with open("CVE-2000-0114valid.txt", "r") as f:

            vulnerable = f.read().strip()

        print(f"\nVulnerable subdomain found:\n{vulnerable}")

    else:

        print("\nNo vulnerable subdomains found.")



    os.remove("subdomains.txt")

    if os.path.exists("CVE-2000-0114valid.txt"):

        os.remove("CVE-2000-0114valid.txt")



    print("\nScan completed.")

    print("=" * 50)

    print("Checkout My LinkedIn")

    print("https://www.linkedin.com/in/josekutty-kunnelthazhe-binu-9b484429b/")



if __name__ == "__main__":

    main()
